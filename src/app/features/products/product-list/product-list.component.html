<section class="products-root container" aria-labelledby="products-heading">
  <div class="products-header">
    <div class="search-wrapper">
      <label class="visually-hidden" for="product-search">Buscar productos</label>
      <input
        id="product-search"
        type="search"
        placeholder="Buscar por nombre, categoría..."
        [formControl]="searchControl"
        class="input-search"
        autocomplete="off"
        aria-label="Buscar productos" />

      <button *ngIf="searchControl.value" class="btn-clear" (click)="clearSearch()" aria-label="Limpiar búsqueda">✕</button>

      <div class="search-loading" *ngIf="loading" aria-hidden="true">⏳</div>
    </div>
  </div>

  <ng-container *ngIf="products$ | async as products; else loadingTpl">
    <div *ngIf="error" class="error">{{ error }}</div>

    <div *ngIf="products.length === 0 && !error" class="empty">No se encontraron productos.</div>

    <div class="grid" *ngIf="products.length > 0" role="list">
      <app-product-card
        role="listitem"
        *ngFor="let p of products; trackBy: trackById"
        [product]="p">
      </app-product-card>
    </div>
  </ng-container>

  <ng-template #loadingTpl>
    <div class="loading">Cargando productos…</div>
  </ng-template>
</section>


